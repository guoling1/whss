{"version":3,"sources":["createMember.js"],"names":["AnimationCountdown","_require","countdown","message","validate","http","getElementById","sendCode","document","mobile","code","submit","invite","inviteCode","layer","login","browser","elastic_touch","mySwiper","Swiper","mcid","isDeposited","effect","slidesPerView","centeredSlides","coverflow","rotate","stretch","depth","slideShadows","prompt","getElementsByTagName","swip","swiper","i","length","activeIndex","style","display","value","console","log","onSlideChangeStart","getElementsByClassName","getAttribute","addEventListener","phone","check","ajax","type","url","data","alert","error","prompt_show","submit_start","joint","dataType","consumerCellphone","openID","$","val","userID","source","cid","flag","status","href","mid","result"],"mappings":"YAKA,IAAMA,oBAAqBC,SAAS,iBADpCC,UAAA,GAAAF,oBAAA,WAAA,QAEIE,SAAYD,SAAID,YACpBG,QAAAF,SAAA,WACMG,KAAAA,SAAWH,QAEXI,OAAOJ,SAASK,eAAtB,UACAC,SAAAC,SAAAF,eAAA,YACMG,KAASD,SAASF,eAAe,QACjCC,OAAWC,SAASF,eAAe,UACnCI,OAAOF,SAASF,eAAe,UAC/BK,WAASH,SAASF,eAAe,cACjCM,MAASJ,SAASF,eAAe,SACjCO,OAAAA,SAAaL,eAASF,UACtBQ,MAAQN,SAASF,eAAe,SAEhCS,QAAQP,SAASF,UACvBU,SAAAC,eAEAD,IAAAA,MAAQC,YAGJC,SAAW,GAAIC,QAAO,qBADtBC,OAAKC,YACLH,cAAeC,KACfG,gBAAS,EACTC,WACAC,OAAAA,GACAC,QAAW,GACPC,MAAAA,GACAC,SAAS,EACTC,cAHO,GAKPC,OAAAA,SAAAA,GAMR,IAAA,GAf+CC,GAAAtB,SAAAF,eAAA,UAAAyB,qBAAA,KAWnCC,EAAAxB,SAASyB,uBAAO,aAI5BC,EAAA,EAAAA,EAAAJ,EAAAK,OAAAD,IACAA,GAAAD,EAAAG,aACYN,EAAJI,GAAYA,MAAEJ,QAAOK,QACdD,KAAGD,EAAOG,GAAAA,MACTN,YAAUO,EAAMC,GAAAA,aAAhB,eACAlB,QAAOY,IAAKE,KAAGK,cAEfC,EAAAA,GAAQC,MAARH,QAAiBjB,QAIxBqB,mBAAA,SAAAT,GAAAO,QAAAC,IAAAR,EAAAG,YAEgCI,KAAAA,GA5BMV,GAAAtB,SAAAF,eAAA,UAAAyB,qBAAA,KA4B3CW,EAAAA,SAAmBC,uBAAA,aAA0BF,EAAAA,EAAIR,EAAAA,EAAOG,OAAAA,IAChDN,GAAAA,EAAStB,aACTwB,EAAOxB,GAAAA,MAASmC,QAAAA,QAChBvB,KAAJY,EAAcF,GAAAA,MACPI,YAAUE,EAAAA,GAAAA,aAAY,eACrBN,QAAAW,IAAUJ,KAAMC,cAEhBjB,EAAAA,GAAAA,MAAcW,QAAQY,SAK7BJ,SAAAC,IAAArB,KAAAC,aAYTd,SAASsC,iBAAiB,QAAS,WAC3BzC,SAAS0C,MAAMrC,OAAO8B,QAClBrC,UAAU6C,SAFbF,EAAAA,MACDzC,KAAA,OACIF,IAAAA,wBACE8C,SAAK,OACHC,MACAC,UAFGzC,OAAA8B,OAIHY,MAAM,WACFC,MAAA,SAEJC,QAAO,SAAAF,GACHC,QAAME,YAAN,WARDpD,UAAAqD,oBAyBnB5C,OAAAkC,iBAAA,QAAA,WAeIzC,SAAAoD,OACAV,MAAArC,OAAA8B,MACA7B,KAAAA,KAAA6B,SAEYO,EAAAA,MACMpC,KAAK6B,OACXW,IAAA,2BACGO,SAAA,OACHR,MACKS,kBAAAjD,OAFF8B,MAGHkB,MAHG/C,KAAA6B,MAIGoB,OAAAC,EAAA,WAAAC,MACFC,OAAAF,EAAA,WAA6BrB,MAC7BwB,OAAexB,EAAAA,WAFbsB,MAGFG,IAAaJ,EAAA,QAAFC,MACXzC,KAAaA,KACbC,YAAaA,aAEbgC,MAAA,WACAD,MAAA,SAEJC,QAAO,SAAAF,GACH,WAAMA,EAANc,KAEed,GAAVA,EAAAe,OACGD,SAAME,KAAd,uCACAhB,EAAAiB,IAOIhB,SAAWiB,KAAX,gCAAAlB,EAAAiB,IAAA,cAAA3D,OAAA8B,MAAA,WAAAqB,EAAA,WAAAC,MAGZT,MAAAD,EAAAkB","file":"createMember.min.js","sourcesContent":["/**\r\n * Created by administrator on 2016/12/8.\r\n */\r\n\r\n// 引入动画模版 处理验证码\r\nconst AnimationCountdown = _require('art-countdown');\r\nlet countdown = new AnimationCountdown('sendCode', '重新获取');\r\n// 引入http message\r\nconst validate = _require('validate');\r\nconst message = _require('message');\r\nconst http = _require('http');\r\n// 定义变量\r\nconst mobile = document.getElementById('mobile');\r\nconst sendCode = document.getElementById('sendCode');\r\nconst code = document.getElementById('code');\r\nconst submit = document.getElementById('submit');\r\nconst invite = document.getElementById('invite');\r\nconst inviteCode = document.getElementById('inviteCode');\r\nconst layer = document.getElementById('layer');\r\nconst cancel = document.getElementById('cancel');\r\nconst login = document.getElementById('login');\r\n// 引入浏览器特性处理\r\nconst browser = _require('browser');\r\nbrowser.elastic_touch();\r\n\r\nvar mcid,isDeposited;\r\nvar mySwiper = new Swiper('.swiper-container', {\r\n    effect : 'coverflow',\r\n    slidesPerView: 1.25,\r\n    centeredSlides: true,\r\n    coverflow: {\r\n        rotate: 30,\r\n        stretch: 10,\r\n        depth: 60,\r\n        modifier: 2,\r\n        slideShadows : false\r\n    },\r\n    onInit: function(swiper){\r\n        var prompt = document.getElementById('prompt').getElementsByTagName('p');\r\n        var swip = document.getElementsByClassName('swiperInp');\r\n//            window.pageData.mcid = swip.value;\r\n//            window.pageData.isDeposited = swip.getAttribute('isDeposited');\r\n//            console.log(window.pageData)\r\n        for(var i=0;i<prompt.length;i++){\r\n            if(i==swiper.activeIndex){\r\n                prompt[i].style.display='block';\r\n                mcid = swip[i].value;\r\n                isDeposited = swip[i].getAttribute('isDeposited');\r\n                console.log(mcid,isDeposited)\r\n            }else {\r\n                prompt[i].style.display='none'\r\n            }\r\n        }\r\n    },\r\n    onSlideChangeStart:function(swiper){ console.log(swiper.activeIndex);\r\n        var prompt = document.getElementById('prompt').getElementsByTagName('p');\r\n        var swip = document.getElementsByClassName('swiperInp');\r\n        for(var i=0;i<prompt.length;i++){\r\n            if(i==swiper.activeIndex){\r\n                prompt[i].style.display='block';\r\n                mcid = swip[i].value;\r\n                isDeposited = swip[i].getAttribute('isDeposited');\r\n                console.log(mcid,isDeposited)\r\n            }else {\r\n                prompt[i].style.display='none'\r\n            }\r\n        }\r\n    }\r\n})\r\nconsole.log(mcid,isDeposited)\r\n/*if (!pageData.qrCode || pageData.qrCode == '') {\r\n    invite.style.display = 'block';\r\n}\r\n\r\nif (!pageData.inviteCode || pageData.inviteCode == '') {\r\n    inviteCode.readonly = false;\r\n}*/\r\n\r\nsendCode.addEventListener('click', function () {\r\n    if (validate.phone(mobile.value)) {\r\n        if (countdown.check()) {\r\n            $.ajax({\r\n                type: \"post\",\r\n                url: \"/membership/sendVcode\",\r\n                dataType: \"json\",\r\n                data: {\r\n                    \"cellphone\"          :   mobile.value\r\n                },\r\n                error: function () {\r\n                    alert(\"请求失败\")\r\n                },\r\n                success: function (data) {\r\n                    message.prompt_show('验证码发送成功');\r\n                    countdown.submit_start();\r\n                }\r\n            });\r\n        }\r\n    }\r\n});\r\n\r\n// cancel.addEventListener('click', function () {\r\n//     layer.style.display = 'none';\r\n// });\r\n//\r\n// login.addEventListener('click', function () {\r\n//     window.location.href = '/sqb/login?phone=' + mobile.value;\r\n// });\r\n//\r\n\r\nsubmit.addEventListener('click', ()=> {\r\n    // if (!pageData.qrCode || pageData.qrCode == '') {\r\n    //     if (validate.joint({\r\n    //             phone: mobile.value,\r\n    //             code: code.value\r\n    //         })) {\r\n    //         http.post('/wx/login', {\r\n    //             mobile: mobile.value,\r\n    //             code: code.value,\r\n    //             inviteCode: inviteCode.value\r\n    //         }, ()=> {\r\n    //             window.location.replace(\"/sqb/addInfo\");\r\n    //         })\r\n    //     }\r\n    // } else {\r\n        if (validate.joint({\r\n                phone: mobile.value,\r\n                code: code.value\r\n            })) {\r\n            $.ajax({\r\n                type: \"post\",\r\n                url: \"/membership/createMember\",\r\n                dataType: \"json\",\r\n                data: {\r\n                    \"consumerCellphone\" : mobile.value,\r\n                    \"vcode\" : code.value,\r\n                    \"openID\" : $(\"#openID\").val(),\r\n                    \"userID\" : $(\"#userID\").val(),\r\n                    \"source\" : $(\"#source\").val(),\r\n                    \"cid\" : $(\"#cid\").val(),\r\n                    \"mcid\" : mcid,\r\n                    \"isDeposited\" : isDeposited\r\n                },\r\n                error: function () {\r\n                    alert(\"请求失败\")\r\n                },\r\n                success: function (data) {\r\n                    if(data.flag==\"success\")\r\n                    {\r\n                        if(data.status==1)\r\n                            location.href=\"/membership/createMemberSuccess?mid=\"+data.mid;\r\n                        else\r\n                            location.href=\"/membership/needRecharge?mid=\"+data.mid+\"&cellphone=\"+mobile.value+\"&source=\"+$(\"#source\").val();\r\n                    }\r\n                    else\r\n                        alert(data.result);\r\n                }\r\n            });\r\n            // http.post('/wx/login', {\r\n            //     mobile: mobile.value,\r\n            //     code: code.value,\r\n            //     qrCode: pageData.qrCode,\r\n            //     inviteCode: inviteCode.value\r\n            // }, ()=> {\r\n            //     window.location.replace(\"/sqb/addInfo\");\r\n            // })\r\n        }\r\n    // }\r\n});"]}