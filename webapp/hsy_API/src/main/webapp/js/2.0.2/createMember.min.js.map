{"version":3,"sources":["createMember.js"],"names":["AnimationCountdown","_require","countdown","message","validate","http","getElementById","sendCode","document","mobile","code","submit","cancel","browser","elastic_touch","mySwiper","Swiper","mcid","isDeposited","effect","slidesPerView","centeredSlides","coverflow","rotate","stretch","depth","slideShadows","prompt","getElementsByTagName","swip","swiper","i","length","activeIndex","style","display","value","console","log","onSlideChangeStart","getElementsByClassName","getAttribute","pageData","consumeCellphone","readOnly","addEventListener","phone","check","ajax","type","url","data","alert","error","prompt_show","submit_start","joint","dataType","consumerCellphone","openID","$","val","userID","source","cid","flag","status","location","href","mid","result"],"mappings":"YAKA,IAAMA,oBAAqBC,SAAS,iBADpCC,UAAA,GAAAF,oBAAA,WAAA,QAEIE,SAAYD,SAAID,YACpBG,QAAAF,SAAA,WACMG,KAAAA,SAAWH,QAEXI,OAAOJ,SAASK,eAAtB,UACAC,SAAAC,SAAAF,eAAA,YACMG,KAASD,SAASF,eAAe,QACjCC,OAAWC,SAASF,eAAe,UACnCI,MAAOF,SAASF,eAAe,SAC/BK,OAASH,SAASF,eAAe,UAEjCM,QAASJ,SAASF,UACxBO,SAAAC,eAEAD,IAAAA,MAAQC,YAGJC,SAAW,GAAIC,QAAO,qBADtBC,OAAKC,YACLH,cAAeC,KACfG,gBAAS,EACTC,WACAC,OAAAA,EACAC,SAAW,GACPC,MAAAA,IACAC,SAAU,EACVC,cAHO,GAKPC,OAAAA,SAAAA,GAGA,IAAIC,GAZmCA,GAAAnB,SAAAF,eAAA,UAAAsB,qBAAA,KAWnCC,EAAArB,SAASsB,uBAAO,aAChBH,EAAAA,EAAAA,EAASnB,EAAAA,OAASF,IAClBuB,GAAAA,EAAOrB,aACPmB,EAAJI,GAAYA,MAAEJ,QAAOK,QACdD,KAAGD,EAAOG,GAAAA,MACTN,YAAUO,EAAMC,GAAAA,aAAhB,eACAlB,QAAOY,IAAKE,KAAGK,cAEfC,EAAAA,GAAQC,MAARH,QAAiBjB,QAIxBqB,mBAAA,SAAAT,GAAAO,QAAAC,IAAAR,EAAAG,YAEgCI,KAAAA,GAzBMV,GAAAnB,SAAAF,eAAA,UAAAsB,qBAAA,KAyB3CW,EAAAA,SAAmBC,uBAAA,aAA0BF,EAAAA,EAAIR,EAAAA,EAAOG,OAAAA,IAChDN,GAAAA,EAASnB,aACTqB,EAAOrB,GAAAA,MAASgC,QAAAA,QAChBvB,KAAJY,EAAcF,GAAAA,MACPI,YAAUE,EAAAA,GAAAA,aAAY,eACrBN,QAAAW,IAAUJ,KAAMC,cAEhBjB,EAAAA,GAAAA,MAAcW,QAAQY,SAMjC,KAAAC,SAAAC,kBAtCLlC,OAAA2B,MAAAM,SAAAC,iBA2CIlC,OAAOmC,SAAW,QADlBnC,OAAO2B,MAAQM,GAKfnC,SAAAsC,iBAAA,QAAA,WACHzC,SAAA0C,MAAArC,OAAA2B,QAIWlC,UAAU6C,SAFbF,EAAAA,MACDzC,KAAA,OACIF,IAAAA,wBACE8C,SAAK,OACHC,MACAC,UAFGzC,OAAA2B,OAIHe,MAAM,WACFC,MAAA,SAEJC,QAAO,SAAAF,GACHC,QAAME,YAAN,WARDpD,UAAAqD,oBAgBd5C,OAAAkC,iBAAA,QAAA,WAnBLzC,SAAAoD,OAwBgBV,MAAOrC,OAAO2B,MAFvBS,KAAAA,KAAiBT,SAERU,EAAAA,MACMpC,KAAK0B,OACXc,IAAA,2BACGO,SAAA,OACHR,MACKS,kBAAAjD,OAFF2B,MAGHqB,MAHG/C,KAAA0B,MAIGuB,OAAAC,EAAA,WAAAC,MACFC,OAAAF,EAAA,WAA6BxB,MAC7B2B,OAAe3B,EAAAA,WAFbyB,MAGFG,IAAaJ,EAAA,QAAFC,MACX5C,KAAaA,KACbC,YAAaA,aAEbmC,MAAA,WACAD,MAAA,SAEJC,QAAO,SAAAF,GACH,WAAMA,EAANc,KAfD,GAAAd,EAAAe,OAiBMC,SAAAC,KAAA,uCAAgBjB,EAAAkB,IAEdlB,SAAAiB,KACCD,yBAAchB,EAAAkB,IAAA,cAAA5D,OAAA2B,MAAuCe,WAErDgB,EAAAA,WAAAN,MACY,cAAXV,EAAKc,KACVE,SAAAC,KAAgB,8BAA8BjB,EAAKkB,IAAI,WAAvCT,EAAkDA,WAAAC,MAxB9ET,MAAAD,EAAAmB","file":"createMember.min.js","sourcesContent":["/**\r\n * Created by administrator on 2016/12/8.\r\n */\r\n\r\n// 引入动画模版 处理验证码\r\nconst AnimationCountdown = _require('art-countdown');\r\nlet countdown = new AnimationCountdown('sendCode', '重新获取');\r\n// 引入http message\r\nconst validate = _require('validate');\r\nconst message = _require('message');\r\nconst http = _require('http');\r\n// 定义变量\r\nconst mobile = document.getElementById('mobile');\r\nconst sendCode = document.getElementById('sendCode');\r\nconst code = document.getElementById('code');\r\nconst submit = document.getElementById('submit');\r\nconst layer = document.getElementById('layer');\r\nconst cancel = document.getElementById('cancel');\r\n// 引入浏览器特性处理\r\nconst browser = _require('browser');\r\nbrowser.elastic_touch();\r\n\r\nvar mcid,isDeposited;\r\nvar mySwiper = new Swiper('.swiper-container', {\r\n    effect : 'coverflow',\r\n    slidesPerView: 1.35,\r\n    centeredSlides: true,\r\n    coverflow: {\r\n        rotate: 0,\r\n        stretch: -50,\r\n        depth: 200,\r\n        modifier: 1,\r\n        slideShadows : false\r\n    },\r\n    onInit: function(swiper){\r\n        var prompt = document.getElementById('prompt').getElementsByTagName('p');\r\n        var swip = document.getElementsByClassName('swiperInp');\r\n        for(var i=0;i<prompt.length;i++){\r\n            if(i==swiper.activeIndex){\r\n                prompt[i].style.display='block';\r\n                mcid = swip[i].value;\r\n                isDeposited = swip[i].getAttribute('isDeposited');\r\n                console.log(mcid,isDeposited)\r\n            }else {\r\n                prompt[i].style.display='none'\r\n            }\r\n        }\r\n    },\r\n    onSlideChangeStart:function(swiper){ console.log(swiper.activeIndex);\r\n        var prompt = document.getElementById('prompt').getElementsByTagName('p');\r\n        var swip = document.getElementsByClassName('swiperInp');\r\n        for(var i=0;i<prompt.length;i++){\r\n            if(i==swiper.activeIndex){\r\n                prompt[i].style.display='block';\r\n                mcid = swip[i].value;\r\n                isDeposited = swip[i].getAttribute('isDeposited');\r\n                console.log(mcid,isDeposited)\r\n            }else {\r\n                prompt[i].style.display='none'\r\n            }\r\n        }\r\n    }\r\n})\r\n\r\nif(pageData.consumeCellphone!=''){\r\n    mobile.value = pageData.consumeCellphone;\r\n    mobile.readOnly = 'true'\r\n}else {\r\n    mobile.value = '';\r\n    // mobile.removeAttribute('readOnly')\r\n    // mobile.readOnly = 'false'\r\n}\r\n\r\nsendCode.addEventListener('click', function () {\r\n    if (validate.phone(mobile.value)) {\r\n        if (countdown.check()) {\r\n            $.ajax({\r\n                type: \"post\",\r\n                url: \"/membership/sendVcode\",\r\n                dataType: \"json\",\r\n                data: {\r\n                    \"cellphone\"          :   mobile.value\r\n                },\r\n                error: function () {\r\n                    alert(\"请求失败\")\r\n                },\r\n                success: function (data) {\r\n                    message.prompt_show('验证码发送成功');\r\n                    countdown.submit_start();\r\n                }\r\n            });\r\n        }\r\n    }\r\n});\r\n\r\nsubmit.addEventListener('click', ()=> {\r\n        if (validate.joint({\r\n                phone: mobile.value,\r\n                code: code.value\r\n            })) {\r\n            $.ajax({\r\n                type: \"post\",\r\n                url: \"/membership/createMember\",\r\n                dataType: \"json\",\r\n                data: {\r\n                    \"consumerCellphone\" : mobile.value,\r\n                    \"vcode\" : code.value,\r\n                    \"openID\" : $(\"#openID\").val(),\r\n                    \"userID\" : $(\"#userID\").val(),\r\n                    \"source\" : $(\"#source\").val(),\r\n                    \"cid\" : $(\"#cid\").val(),\r\n                    \"mcid\" : mcid,\r\n                    \"isDeposited\" : isDeposited\r\n                },\r\n                error: function () {\r\n                    alert(\"请求失败\")\r\n                },\r\n                success: function (data) {\r\n                    if(data.flag==\"success\") {\r\n                        if(data.status==1)\r\n                            location.href=\"/membership/createMemberSuccess?mid=\"+data.mid;\r\n                        else\r\n                            location.href=\"/sqb/needRecharge?mid=\"+data.mid+\"&cellphone=\"+mobile.value+\"&source=\"+$(\"#source\").val();\r\n                    }else if(data.flag==\"memberInfo\"){\r\n                        location.href = \"/membership/memberInfo?mid=\"+data.mid+\"&source=\"+$(\"#source\").val();\r\n                    }\r\n                    else\r\n                        alert(data.result);\r\n                }\r\n            });\r\n        }\r\n});"]}