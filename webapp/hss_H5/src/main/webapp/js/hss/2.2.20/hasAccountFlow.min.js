'use strict';

/**
 * Created by administrator on 2016/12/8.
 */

// 引入浏览器特性处理
var browser = _require('browser');
browser.elastic_touch('list');
// 引入动画模版 处理验证码
var AnimationCountdown = _require('art-countdown');
var countdown = new AnimationCountdown('sendCode', '重新获取');
// 引入http message
var validate = _require('validate');
var message = _require('message');
var http = _require('http');

// 定义ajax事件
var empty = document.getElementById('empty');
var content = document.getElementById('content');
var list = document.createElement('list');
var nowPage = 1;
var more = document.createElement('div');
more.className = 'touch_more';
more.innerHTML = '加载更多';
more.style.display = 'none';
more.style.height = '50px';
more.style.lineHeight = '50px';
more.style.fontSize = '16px';
more.style.color = '#999';
more.style.backgroundColor = '#f4f5f8';
more.addEventListener('touchstart', function () {
  more.style.backgroundColor = '#d8d7dc';
});
more.addEventListener('touchend', function () {
  more.style.backgroundColor = '#f4f5f8';
});
more.addEventListener('click', function () {
  getData(null, nowPage + 1);
});
content.appendChild(more);

var getData = function getData(e, page) {
  // 检查page 如果page为1 清空content数据
  nowPage = page || 1;
  if (nowPage == 1) {
    list.innerHTML = '';
  }
  http.post('/account/flowDetails', {
    pageNo: nowPage,
    pageSize: 20
  }, function (res) {
    if (res.count == 0) {
      empty.style.display = 'block';
      return;
    }
    empty.style.display = 'none';
    for (var i = 0; i < res.records.length; i++) {
      var div_list = document.createElement('div');
      div_list.className = 'flow-group';
      var div_left = document.createElement('div');
      div_left.className = 'flow-left';
      var div_top = document.createElement('div');
      div_top.className = 'flow-top';
      var div_span = document.createElement('span');
      if (res.records[i].incomeAmount > 0) {
        div_span.innerHTML = '收入';
      } else {
        div_span.innerHTML = '支出';
      }
      var div_spanS = document.createElement('span');
      div_spanS.className = 's';
      if (res.records[i].remark == '支付') {
        div_spanS.innerHTML = '收款';
      } else {
        div_spanS.innerHTML = res.records[i].remark;
      }
      div_top.appendChild(div_span);
      div_top.appendChild(div_spanS);
      var div_bottom = document.createElement('div');
      div_bottom.className = 'flow-bottom';
      div_bottom.innerHTML = res.records[i].createTime;
      div_left.appendChild(div_top);
      div_left.appendChild(div_bottom);
      var div_right = document.createElement('div');
      if (res.records[i].incomeAmount > 0) {
        div_right.className = 'flow-right green';
        div_right.innerHTML = '+' + res.records[i].incomeAmount;
      } else {
        div_right.className = 'flow-right red';
        div_right.innerHTML = '-' + res.records[i].outAmount;
      }
      div_list.appendChild(div_left);
      div_list.appendChild(div_right);
      list.appendChild(div_list);
    }
    // 判断是否还有下一页
    if (res.hasNextPage) {
      more.style.display = 'block';
    } else {
      more.style.display = 'none';
    }
    content.insertBefore(list, content.childNodes[0]);
  });
};
// 初始化数据
getData();
//# sourceMappingURL=hasAccountFlow.min.js.map
