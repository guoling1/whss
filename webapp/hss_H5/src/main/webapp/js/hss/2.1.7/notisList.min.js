'use strict';

/**
 * Created by administrator on 2016/12/13.
 */

// 引入 message http
var message = _require('message');
var http = _require('http');
var tools = _require('tools');
// 引入浏览器特性处理
var browser = _require('browser');
browser.elastic_touch('list');
// 定义ajax事件
var content = document.getElementById('content');
var list = document.createElement('list');
var nowPage = 1;
var more = document.createElement('div');
more.className = 'touch_more';
more.innerHTML = '加载更多';
more.style.display = 'none';
more.style.height = '50px';
more.style.lineHeight = '50px';
more.style.fontSize = '16px';
more.style.color = '#999';
more.style.backgroundColor = '#f4f5f8';
more.addEventListener('touchstart', function () {
  more.style.backgroundColor = '#d8d7dc';
});
more.addEventListener('touchend', function () {
  more.style.backgroundColor = '#f4f5f8';
});
more.addEventListener('click', function () {
  getData(null, nowPage + 1);
});
content.appendChild(more);

var getData = function getData(e, page) {
  // 检查page 如果page为1 清空content数据
  nowPage = page || 1;
  if (nowPage == 1) {
    list.innerHTML = '';
  }
  http.post('/notice/noticeList', {
    pageNo: nowPage,
    pageSize: 20
  }, function (res) {
    console.log(res.records);

    var _loop = function _loop(i) {
      var div_list = document.createElement('div');
      div_list.className = 'list-li';
      div_list.onclick = function () {
        window.location.href = '/notice/noticeDetailsJSP?id=' + res.records[i].id;
      };
      var div_icon = document.createElement('div');
      if (res.records[i].type == 1) {
        div_icon.className = 'list-icon notice2';
      } else {
        div_icon.className = 'list-icon notice1';
      }
      var div_info = document.createElement('div');
      div_info.className = 'list-info';
      var div_top = document.createElement('div');
      div_top.className = 'top';
      div_top.innerHTML = res.records[i].title;
      var div_bottom = document.createElement('div');
      div_bottom.className = 'bottom';
      div_bottom.innerHTML = res.records[i].dates;
      div_info.appendChild(div_top);
      div_info.appendChild(div_bottom);
      var div_right = document.createElement('div');
      div_right.className = 'list-right';
      div_list.appendChild(div_icon);
      div_list.appendChild(div_info);
      div_list.appendChild(div_right);
      list.appendChild(div_list);
    };

    for (var i = 0; i < res.records.length; i++) {
      _loop(i);
    }
    // 判断是否还有下一页
    if (res.hasNextPage) {
      more.style.display = 'block';
    } else {
      more.style.display = 'none';
    }
    content.insertBefore(list, content.childNodes[0]);
  });
};
// 初始化数据
getData();
//# sourceMappingURL=notisList.min.js.map
