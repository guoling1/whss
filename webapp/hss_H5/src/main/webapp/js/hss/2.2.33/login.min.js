'use strict';

/**
 * Created by administrator on 2016/12/8.
 */

// 引入动画模版 处理验证码
var AnimationCountdown = _require('art-countdown');
var countdown = new AnimationCountdown('sendCode', '重新获取');
// 引入http message
var validate = _require('validate');
var message = _require('message');
var http = _require('http');
// 引入常用工具
var tools = _require('tools');
var argument = tools.GetUrlArg();
console.log(argument);
// 定义变量
var mobile = document.getElementById('mobile');
var sendCode = document.getElementById('sendCode');
var submit = document.getElementById('submit');
// 引入浏览器特性处理
var browser = _require('browser');
browser.elastic_touch();

sendCode.addEventListener('click', function () {
  if (validate.phone(mobile.value)) {
    if (countdown.check()) {
      http.post('/wx/getLoginCode', {
        mobile: mobile.value
      }, function () {
        message.prompt_show('验证码发送成功');
        countdown.submit_start();
      });
    }
  }
});

// 登录
submit.addEventListener('click', function () {
  if (validate.joint({
    phone: mobile.value,
    code: code.value
  })) {
    http.post('/wx/directLogin', {
      mobile: mobile.value,
      code: code.value,
      oemNo: pageData.oemNo
    }, function () {
      window.location.replace("/sqb/wallet?oemNo=" + pageData.oemNo);
    });
  }
});

if (argument.phone) {
  mobile.value = argument.phone;
  sendCode.click();
}
//# sourceMappingURL=login.min.js.map
