'use strict';

/**
 * Created by administrator on 2016/12/9.
 */

// 引入http message
var message = _require('message');
var http = _require('http');
// 引入 touch 动画
var Touch = _require('touch');
new Touch('touch_op', '#4b65a8', 'deep', '0.2');
new Touch('touch_gr', '#FFF', 'deep', '0.1');
// 引入浏览器特性处理
var browser = _require('browser');
browser.elastic_touch();
// 定义变量
var layer = document.getElementById('layer');
var xx = document.getElementById('xx');
var cancel = document.getElementById('cancel');
var unbundling = document.getElementById('unbundling');
var unbundlingSubmit = document.getElementById('unbundlingSubmit');
var upgrade = document.getElementById('show_upgrade');
var announcement_link = document.getElementById('announcement-link');
announcement_link.addEventListener('click', function () {
  window.location.href = "/notice/noticeListJSP";
});

// 公告横向的滚动
var announcement = document.getElementById('announcement');
var announcement_text_box = document.getElementById('announcement-text-box');
var announcement_text = document.getElementById('announcement-text');

var pxPerRem = document.documentElement.clientWidth;
upgrade.addEventListener('click', function () {
  if (pxPerRem >= 350) {
    window.location.href = '/sqb/upgradeMax';
  } else {
    window.location.href = '/sqb/upgradeMin';
  }
});
// 是否展示升级功能
if (pageData.showRecommend == 2) {
  document.getElementById('show_recommend').style.display = "none";
  document.getElementById('show_upgrade').style.display = "none";
}

// 获取公告数据
http.post('/notice/pageAnnouncement', {}, function (data) {
  if (data) {
    (function () {
      announcement.style.display = 'block';
      announcement_text.innerHTML = data.text.replace(/<[^>]+>/g, "");
      var announcement_text_box_ClientRect = announcement_text_box.getBoundingClientRect();
      var initLeft = announcement_text_box_ClientRect.width;
      var announcement_text_ClientRect = announcement_text.getBoundingClientRect();
      var runLeft = announcement_text_ClientRect.width;
      setInterval(function () {
        var nowLeft = initLeft--;
        announcement_text.style.left = nowLeft + 'px';
        if (nowLeft <= -runLeft) {
          initLeft = announcement_text_box_ClientRect.width;
        }
      }, 15);
      announcement.onclick = function () {
        window.location.href = '/notice/noticeDetailsJSP?id=' + data.id;
      };
    })();
  }
});

// 解绑微信
unbundling.addEventListener('click', function () {
  layer.style.display = 'block';
});

xx.addEventListener('click', function () {
  layer.style.display = 'none';
});

cancel.addEventListener('click', function () {
  layer.style.display = 'none';
});

unbundlingSubmit.addEventListener('click', function () {
  http.post('/wx/unbundling', {}, function (res) {
    message.prompt_show('解绑成功');
    layer.style.display = 'none';
    window.location.href = '/sqb/login';
  });
});
//# sourceMappingURL=wallet.min.js.map
