{"version":3,"sources":["bank.js"],"names":["http","_require","message","browser","elastic_touch","bankCardBin","bankLogoColor","HasBank","bin","i","length","bankList","document","getElementById","layer","cancel","enter","bankId","addEventListener","style","display","post","getBankList","data","innerHTML","group","createElement","index","bankBin","className","top","logo","info","name","span","bankName","appendChild","cardType","a","hasBranch","localStorage","removeItem","setItem","href","pageData","oemNo","source","b","onclick","type","branchName","bottom","XP1","XP2","XP3","p","word","bankNo","s","reserveMobile","small"],"mappings":"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","file":"bank.min.js","sourcesContent":["/**\r\n * Created by administrator on 2016/12/8.\r\n */\r\n\r\n// 引入浏览器特性处理\r\nconst http = _require('http');\r\nconst message = _require('message');\r\nconst browser = _require('browser');\r\nbrowser.elastic_touch();\r\n\r\n// 卡bin和颜色一一对应\r\nlet bankCardBin = ['ABC', 'BANKCOMM', 'BOC', 'CCB', 'CEB', 'CGB', 'CIB', 'CITIC', 'CMB', 'CMBC', 'ICBC', 'PINGAN', 'PSBC', 'SHBANK'];\r\nlet bankLogoColor = ['green', 'blue', 'red', 'blue', 'red', 'red', 'blue', 'red', 'red', 'red', 'red', 'red', 'green', 'red'];\r\n\r\nlet HasBank = (bin) => {\r\n  for (let i = 0; i < bankCardBin.length; i++) {\r\n    if (bankCardBin[i] == bin) {\r\n      return i;\r\n    }\r\n  }\r\n  return -1;\r\n};\r\n\r\nlet bankList = document.getElementById('bankList');\r\nlet layer = document.getElementById('layer');\r\nlet cancel = document.getElementById('cancel');\r\nlet enter = document.getElementById('enter');\r\nlet bankId = '';\r\n\r\ncancel.addEventListener('click', function () {\r\n  layer.style.display = 'none';\r\n});\r\n\r\nenter.addEventListener('click', function () {\r\n  http.post('/wx/deleteCreditCard', {\r\n    bankId: bankId\r\n  }, function () {\r\n    getBankList();\r\n    layer.style.display = 'none';\r\n  })\r\n});\r\n// 获取银行卡列表\r\nlet getBankList = function () {\r\n  http.post('/wx/myCardList', {}, function (data) {\r\n    bankList.innerHTML = '';\r\n    for (let i = 0; i < data.length; i++) {\r\n      let group = document.createElement('div');\r\n      let index = HasBank(data[i].bankBin);\r\n      if (index != -1) {\r\n        group.className = 'group ' + bankLogoColor[index];\r\n      } else {\r\n        group.className = 'group red';\r\n      }\r\n      // group top-start\r\n      let top = document.createElement('div');\r\n      top.className = 'top';\r\n      let logo = document.createElement('div');\r\n      if (index != -1) {\r\n        logo.className = 'logo ' + data[i].bankBin;\r\n      } else {\r\n        logo.className = 'logo DEFAULT';\r\n      }\r\n      let info = document.createElement('div');\r\n      info.className = 'info';\r\n      let name = document.createElement('div');\r\n      name.className = 'name';\r\n      let span = document.createElement('span');\r\n      span.innerHTML = data[i].bankName;\r\n      name.appendChild(span);\r\n      if (data[i].cardType == 0) {\r\n        let a = document.createElement('a');\r\n        if (index != -1) {\r\n          a.className = 'btn ' + bankLogoColor[index];\r\n        } else {\r\n          a.className = 'btn red';\r\n        }\r\n        if (data[i].hasBranch == 0) {\r\n          a.innerHTML = '补充支行信息';\r\n        } else {\r\n          a.innerHTML = '修改支行信息';\r\n        }\r\n        localStorage.removeItem('branch');\r\n        localStorage.setItem('bankId',data[i].bankId);\r\n        a.href = '/sqb/bankBranch/' + data[i].bankId + \"?oemNo=\" + pageData.oemNo+\"&source=\" + pageData.source;\r\n        name.appendChild(a);\r\n      } else {\r\n        let b = document.createElement('div');\r\n        if (index != -1) {\r\n          b.className = 'btn ' + bankLogoColor[index];\r\n        } else {\r\n          b.className = 'btn red';\r\n        }\r\n        b.innerHTML = '删除';\r\n        b.onclick = function () {\r\n          layer.style.display = 'block';\r\n          bankId = data[i].bankId;\r\n        };\r\n        name.appendChild(b);\r\n      }\r\n      let type = document.createElement('div');\r\n      type.className = 'type';\r\n      if (data[i].cardType == 0) {\r\n        if (data[i].hasBranch == 0) {\r\n          type.innerHTML = '储蓄卡';\r\n        } else {\r\n          type.innerHTML = '储蓄卡 ' + ' | ' + data[i].branchName;\r\n        }\r\n      } else {\r\n        type.innerHTML = '信用卡';\r\n      }\r\n      info.appendChild(name);\r\n      info.appendChild(type);\r\n      top.appendChild(logo);\r\n      top.appendChild(info);\r\n      // group top-end\r\n      // group bottom-start\r\n      let bottom = document.createElement('div');\r\n      bottom.className = 'bottom';\r\n      let XP1 = document.createElement('div');\r\n      XP1.className = 'p';\r\n      XP1.innerHTML = '<div class=\"bank_x\"></div><div class=\"bank_x\"></div><div class=\"bank_x\"></div><div class=\"bank_x\"></div>';\r\n      let XP2 = document.createElement('div');\r\n      XP2.className = 'p';\r\n      XP2.innerHTML = '<div class=\"bank_x\"></div><div class=\"bank_x\"></div><div class=\"bank_x\"></div><div class=\"bank_x\"></div>';\r\n      let XP3 = document.createElement('div');\r\n      XP3.className = 'p';\r\n      XP3.innerHTML = '<div class=\"bank_x\"></div><div class=\"bank_x\"></div><div class=\"bank_x\"></div><div class=\"bank_x\"></div>';\r\n      let p = document.createElement('div');\r\n      p.className = 'p';\r\n      let word = document.createElement('div');\r\n      word.className = 'word';\r\n      word.innerHTML = data[i].bankNo;\r\n      p.appendChild(word);\r\n      let s = document.createElement('div');\r\n      s.className = 's';\r\n      s.innerHTML = data[i].reserveMobile;\r\n      bottom.appendChild(XP1);\r\n      bottom.appendChild(XP2);\r\n      bottom.appendChild(XP3);\r\n      bottom.appendChild(p);\r\n      bottom.appendChild(s);\r\n      // group bottom-end\r\n      group.appendChild(top);\r\n      group.appendChild(bottom);\r\n      if (data[i].cardType == 0) {\r\n        // group small-start\r\n        let small = document.createElement('div');\r\n        small.className = 'small';\r\n        small.innerHTML = '该卡用于收款后的自动结算与余额提现';\r\n        // group small-end\r\n        group.appendChild(small);\r\n      }\r\n      bankList.appendChild(group);\r\n    }\r\n  });\r\n};\r\ngetBankList();\r\n"]}