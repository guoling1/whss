{"version":3,"sources":["upload.js"],"names":["validate","_require","message","http","browser","elastic_touch","Upload","submit","document","getElementById","identityFacePic_src","identityOppositePic_src","identityHandPic_src","bankHandPic_src","wx","error","res","console","log","ua","navigator","userAgent","toLowerCase","getLocalImg","id","localId","getLocalImgData","success","setAttribute","localData","upload_identityFacePic","indexOf","upload_identityOppositePic","upload_identityHandPic","upload_bankHandPic","addEventListener","identityFacePic","getServerId","identityOppositePic","identityHandPic","bankHandPic","empty","post","window","location","href"],"mappings":"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","file":"upload.min.js","sourcesContent":["/**\r\n * Created by administrator on 2016/12/15.\r\n */\r\n\r\n\r\n// 引入http message validate\r\nconst validate = _require('validate');\r\nconst message = _require('message');\r\nconst http = _require('http');\r\n// 引入浏览器特性处理\r\nconst browser = _require('browser');\r\nbrowser.elastic_touch('upload');\r\n// 引入wx_upload\r\nconst Upload = _require('upload');\r\n// 定义变量\r\nlet submit = document.getElementById('submit');\r\nlet identityFacePic_src = document.getElementById('identityFacePic_src');\r\nlet identityOppositePic_src = document.getElementById('identityOppositePic_src');\r\nlet identityHandPic_src = document.getElementById('identityHandPic_src');\r\nlet bankHandPic_src = document.getElementById('bankHandPic_src');\r\n\r\nwx.error(function(res){\r\n  console.log(res);\r\n});\r\n\r\nlet ua = navigator.userAgent.toLowerCase();\r\n// 获取本地图片\r\nlet getLocalImg = function (id, localId) {\r\n  wx.getLocalImgData({\r\n    localId: localId,\r\n    success: function (res) {\r\n      document.getElementById(id).setAttribute('src', res.localData);\r\n    }\r\n  });\r\n};\r\n\r\nlet upload_identityFacePic = new Upload('identityFacePic', function (localId) {\r\n  if (ua.indexOf('iphone') >= 0) {\r\n    getLocalImg('identityFacePic_src', localId);\r\n    return;\r\n  }\r\n  document.getElementById('identityFacePic_src').setAttribute('src', localId);\r\n});\r\n\r\nlet upload_identityOppositePic = new Upload('identityOppositePic', function (localId) {\r\n  if (ua.indexOf('iphone') >= 0) {\r\n    getLocalImg('identityOppositePic_src', localId);\r\n    return;\r\n  }\r\n  document.getElementById('identityOppositePic_src').setAttribute('src', localId);\r\n});\r\n\r\nlet upload_identityHandPic = new Upload('identityHandPic', function (localId) {\r\n  if (ua.indexOf('iphone') >= 0) {\r\n    getLocalImg('identityHandPic_src', localId);\r\n    return;\r\n  }\r\n  document.getElementById('identityHandPic_src').setAttribute('src', localId);\r\n});\r\n\r\nlet upload_bankHandPic = new Upload('bankHandPic', function (localId) {\r\n  if (ua.indexOf('iphone') >= 0) {\r\n    getLocalImg('bankHandPic_src', localId);\r\n    return;\r\n  }\r\n  document.getElementById('bankHandPic_src').setAttribute('src', localId);\r\n});\r\n\r\nsubmit.addEventListener('click', function () {\r\n  let identityFacePic = upload_identityFacePic.getServerId();\r\n  let identityOppositePic = upload_identityOppositePic.getServerId();\r\n  let identityHandPic = upload_identityHandPic.getServerId();\r\n  let bankHandPic = upload_bankHandPic.getServerId();\r\n  if (validate.empty(identityFacePic, '身份证正面照片')\r\n    && validate.empty(identityOppositePic, '身份证背面照片')\r\n    && validate.empty(identityHandPic, '手持身份证正面照片')\r\n    && validate.empty(bankHandPic, '手持结算卡正面照片')) {\r\n    http.post('/merchantInfo/savePic', {\r\n      identityFacePic: identityFacePic,\r\n      identityOppositePic: identityOppositePic,\r\n      identityHandPic: identityHandPic,\r\n      bankHandPic: bankHandPic\r\n    }, function () {\r\n      window.location.href = \"/sqb/follow\";\r\n    })\r\n  }\r\n});"]}