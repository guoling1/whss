<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jkm.hss.dealer.dao.ShallProfitDetailDao">
    <insert id="init" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO tb_shall_profit_detail
        (merchant_id,
        product_type,
        payment_sn,
        channel_type,
        total_fee,
        wait_shall_amount,
        wait_shall_origin_amount,
        profit_type,
        is_direct,
        channel_cost,
        channel_shall_amount,
        product_shall_amount,
        first_dealer_id,
        first_shall_amount,
        second_dealer_id,
        second_shall_amount,
        profit_date,
        status
        )VALUES(
        #{merchantId},
        #{productType},
        #{paymentSn},
        #{channelType},
        #{totalFee},
        #{waitShallAmount},
        #{waitShallOriginAmount},
        #{profitType},
        #{isDirect},
        #{channelCost},
        #{channelShallAmount},
        #{productShallAmount},
        #{firstDealerId},
        #{firstShallAmount},
        #{secondDealerId},
        #{secondShallAmount},
        #{profitDate},
        #{status}
        )
    </insert>
    <select id="selectDetailByProfitDateToHss" resultType="com.jkm.hss.dealer.entity.ShallProfitDetail">
        SELECT * FROM tb_shall_profit_detail WHERE product_type = 'hss' AND profit_date = #{profitDate}
    </select>
    <select id="selectMerchantIdByProfitDateToHss" resultType="java.lang.Long">
        SELECT distinct merchant_id FROM tb_shall_profit_detail WHERE product_type = 'hss' AND profit_date = #{profitDate}
    </select>
    <select id="selectSecondCollectMoneyByMerchantIdAndProfitDateToHss" resultType="java.math.BigDecimal">
        SELECT sum(second_shall_amount) FROM tb_shall_profit_detail
        WHERE product_type = 'hss' AND merchant_id = #{merchantId} AND profit_date = #{profitDate} AND profit_type = 1 AND is_direct = 0
    </select>
    <select id="selectFirstCollectMoneyByMerchantIdAndProfitDateToHss" resultType="java.math.BigDecimal">
        SELECT sum(first_shall_amount) FROM tb_shall_profit_detail
        WHERE product_type = 'hss' AND merchant_id = #{merchantId} AND profit_date = #{profitDate} AND profit_type = 1 AND is_direct = 1
    </select>

    <select id="selectFirstWithdrawMoneyByMerchantIdAndProfitDateToHss" resultType="java.math.BigDecimal">
        SELECT sum(first_shall_amount) FROM tb_shall_profit_detail
        WHERE product_type = 'hss' AND merchant_id = #{merchantId} AND profit_date = #{profitDate} AND profit_type = 2 AND is_direct = 1
    </select>
    <select id="selectSecondWithdrawMoneyByMerchantIdAndProfitDateToHss" resultType="java.math.BigDecimal">
        SELECT sum(second_shall_amount) FROM tb_shall_profit_detail
        WHERE  product_type = 'hss' AND merchant_id = #{merchantId} AND profit_date = #{profitDate} AND profit_type = 2 AND is_direct = 0
    </select>

    <select id="selectDealerIdByProfitDateToHss" resultType="java.lang.Long">
        SELECT distinct second_dealer_id FROM tb_shall_profit_detail WHERE product_type = 'hss' AND profit_date = #{profitDate} AND is_direct = 0
    </select>

    <select id="selectFirstCollectMoneyByDealerIdAndProfitDateToHss" resultType="java.math.BigDecimal">
        SELECT sum(first_shall_amount) FROM tb_shall_profit_detail
        WHERE product_type = 'hss' AND second_dealer_id = #{dealerId} AND is_direct = 0 AND profit_type = 1 AND profit_date = #{profitDate}
    </select>
    <select id="selectFirstWithdrawMoneyByDealerIdAndProfitDateToHss" resultType="java.math.BigDecimal">
        SELECT sum(first_shall_amount) FROM tb_shall_profit_detail
        WHERE product_type = 'hss' AND second_dealer_id = #{dealerId} AND is_direct = 0 AND profit_type = 2 AND profit_date = #{profitDate}
    </select>
    <select id="selectSecondYesterdayProfitMoneyToHss" resultType="java.math.BigDecimal">
        SELECT sum(second_shall_amount) FROM tb_shall_profit_detail
        WHERE product_type = 'hss' AND second_dealer_id = #{dealerId} AND is_direct = 0 AND profit_date = #{profitDate}
    </select>
    <select id="selectSecondYesterdayDealMoneyToHss" resultType="java.math.BigDecimal">
        SELECT sum(total_fee) FROM tb_shall_profit_detail
        WHERE product_type = 'hss' AND second_dealer_id = #{dealerId} AND is_direct = 0 AND profit_type = 1 AND profit_date = #{profitDate}
    </select>
    <select id="selectSecondHistoryProfitMoneyToHss" resultType="java.math.BigDecimal">
        SELECT sum(second_shall_amount) FROM tb_shall_profit_detail
        WHERE product_type = 'hss' AND second_dealer_id = #{dealerId} AND is_direct = 0
    </select>
    <select id="selectFirstSecondYesterdayProfitMoneyToHss" resultType="java.math.BigDecimal">
        SELECT sum(first_shall_amount)  FROM tb_shall_profit_detail
        WHERE first_dealer_id = #{dealerId} AND is_direct = 0 AND profit_date = #{profitDate}
    </select>
    <select id="selectFirstSecondHistoryProfitMoneyToHss" resultType="java.math.BigDecimal">
        SELECT sum(first_shall_amount)  FROM tb_shall_profit_detail
        WHERE product_type = 'hss' AND first_dealer_id = #{dealerId} AND is_direct = 0
    </select>
    <select id="selectFirstMerchantYesterdayProfitMoneyToHss" resultType="java.math.BigDecimal">
        SELECT sum(first_shall_amount)  FROM tb_shall_profit_detail
        WHERE product_type = 'hss' AND first_dealer_id = #{dealerId} AND is_direct = 1 AND profit_date = #{profitDate}
    </select>
    <select id="selectFirstMerchantHistoryProfitMoneyToHss" resultType="java.math.BigDecimal">
        SELECT sum(first_shall_amount)  FROM tb_shall_profit_detail
        WHERE product_type = 'hss' AND first_dealer_id = #{dealerId} AND is_direct = 1
    </select>
    <select id="selectFirstYesterdayDealMoneyToHss" resultType="java.math.BigDecimal">
        SELECT sum(total_fee)  FROM tb_shall_profit_detail
        WHERE product_type = 'hss' AND first_dealer_id = #{dealerId} AND is_direct = 1 AND profit_type = 1 AND profit_date = #{profitDate}
    </select>
    <select id="selectByOrderIdToHss" resultType="com.jkm.hss.dealer.entity.ShallProfitDetail">
        SELECT * FROM tb_shall_profit_detail where product_type = 'hss' AND payment_sn = #{orderId}
    </select>
    <select id="selectCompanyCollectProfitByProfitDateToHss" resultType="java.math.BigDecimal">
        SELECT sum(channel_shall_amount + product_shall_amount) FROM tb_shall_profit_detail
        WHERE product_type = 'hss' AND profit_date = #{profitDate} AND profit_type = 1
    </select>
    <select id="selectCompanyWithdrawProfitByProfitDateToHss" resultType="java.math.BigDecimal">
        SELECT sum(channel_shall_amount + product_shall_amount) FROM tb_shall_profit_detail
        WHERE product_type = 'hss' AND profit_date = #{profitDate} AND profit_type = 2
    </select>
    <select id="selectByProfitDateAndSecondDealerIdToHss" resultType="com.jkm.hss.dealer.entity.ShallProfitDetail">
        SELECT * FROM tb_shall_profit_detail WHERE product_type = 'hss' AND second_dealer_id = #{secondDealerId}
        AND profit_date = #{statisticsDate}
    </select>
    <select id="selectByProfitDateAndFirstDealerIdToHss" resultType="com.jkm.hss.dealer.entity.ShallProfitDetail">
        SELECT * FROM tb_shall_profit_detail WHERE product_type = 'hss' AND first_dealer_id = #{firstDealerId}
        AND profit_date = #{statisticsDate}
    </select>
    <select id="selectCompanyByProfitDateToHss" resultType="com.jkm.hss.dealer.entity.ShallProfitDetail">
        SELECT * FROM tb_shall_profit_detail WHERE product_type = 'hss' AND profit_date = #{profitDate}
    </select>
    <select id="getMerchantIdByProfitDateToHss" resultType="java.lang.Long">
        SELECT distinct(merchant_id) FROM tb_shall_profit_detail WHERE product_type = 'hss' AND profit_date = #{statisticsDate}
    </select>
</mapper>