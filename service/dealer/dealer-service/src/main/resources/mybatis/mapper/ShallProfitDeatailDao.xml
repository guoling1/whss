<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jkm.hss.dealer.dao.ShallProfitDetailDao">
    <insert id="init" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO tb_shall_profit_detail
        (merchant_id,
        payment_sn,
        channel_type,
        total_fee,
        wait_shall_amount,
        wait_shall_origin_amount,
        profit_type,
        is_direct,
        channel_cost,
        channel_shall_amount,
        product_shall_amount,
        first_dealer_id,
        first_shall_amount,
        second_dealer_id,
        second_shall_amount,
        profit_date,
        status
        )VALUES(
        #{merchantId},
        #{paymentSn},
        #{channelType},
        #{totalFee},
        #{waitShallAmount},
        #{waitShallOriginAmount},
        #{profitType},
        #{isDirect},
        #{channelCost},
        #{channelShallAmount},
        #{productShallAmount},
        #{firstDealerId},
        #{firstShallAmount},
        #{secondDealerId},
        #{secondShallAmount},
        #{profitDate},
        #{status}
        )
    </insert>
    <select id="selectDeatailByProfitDate" resultType="com.jkm.hss.dealer.entity.ShallProfitDetail">
        SELECT * FROM tb_shall_profit_detail WHERE profit_date = #{profitDate}
    </select>
    <select id="selectMerchantIdByProfitDate" resultType="java.lang.Long">
        SELECT distinct merchant_id FROM tb_shall_profit_detail WHERE profit_date = #{profitDate}
    </select>
    <select id="selectSecondCollectMoneyByMerchantIdAndProfitDate" resultType="java.math.BigDecimal">
        SELECT sum(second_shall_amount) FROM tb_shall_profit_detail
        WHERE merchant_id = #{merchantId} AND profit_date = #{profitDate} AND profit_type = 1 AND is_direct = 0
    </select>
    <select id="selectFirstCollectMoneyByMerchantIdAndProfitDate" resultType="java.math.BigDecimal">
        SELECT sum(first_shall_amount) FROM tb_shall_profit_detail
        WHERE merchant_id = #{merchantId} AND profit_date = #{profitDate} AND profit_type = 1 AND is_direct = 1
    </select>

    <select id="selectFirstWithdrawMoneyByMerchantIdAndProfitDate" resultType="java.math.BigDecimal">
        SELECT sum(first_shall_amount) FROM tb_shall_profit_detail
        WHERE merchant_id = #{merchantId} AND profit_date = #{profitDate} AND profit_type = 2 AND is_direct = 1
    </select>
    <select id="selectSecondWithdrawMoneyByMerchantIdAndProfitDate" resultType="java.math.BigDecimal">
        SELECT sum(second_shall_amount) FROM tb_shall_profit_detail
        WHERE merchant_id = #{merchantId} AND profit_date = #{profitDate} AND profit_type = 2 AND is_direct = 0
    </select>

    <select id="selectDealerIdByProfitDate" resultType="java.lang.Long">
        SELECT distinct second_dealer_id FROM tb_shall_profit_detail WHERE profit_date = #{profitDate} AND is_direct = 0
    </select>

    <select id="selectFirstCollectMoneyByDealerIdAndProfitDate" resultType="java.math.BigDecimal">
        SELECT sum(first_shall_amount) FROM tb_shall_profit_detail
        WHERE second_dealer_id = #{dealerId} AND is_direct = 0 AND profit_type = 1 AND profit_date = #{profitDate}
    </select>
    <select id="selectFirstWithdrawMoneyByDealerIdAndProfitDate" resultType="java.math.BigDecimal">
        SELECT sum(first_shall_amount) FROM tb_shall_profit_detail
        WHERE second_dealer_id = #{dealerId} AND is_direct = 0 AND profit_type = 2 AND profit_date = #{profitDate}
    </select>
    <select id="selectSecondYesterdayProfitMoney" resultType="java.math.BigDecimal">
        SELECT sum(second_shall_amount) FROM tb_shall_profit_detail
        WHERE second_dealer_id = #{dealerId} AND is_direct = 0 AND profit_date = #{profitDate}
    </select>
    <select id="selectSecondYesterdayDealMoney" resultType="java.math.BigDecimal">
        SELECT sum(total_fee) FROM tb_shall_profit_detail
        WHERE second_dealer_id = #{dealerId} AND is_direct = 0 AND profit_type = 1 AND profit_date = #{profitDate}
    </select>
    <select id="selectSecondHistoryProfitMoney" resultType="java.math.BigDecimal">
        SELECT sum(second_shall_amount) FROM tb_shall_profit_detail
        WHERE second_dealer_id = #{dealerId} AND is_direct = 0
    </select>
    <select id="selectFirstSecondYesterdayProfitMoney" resultType="java.math.BigDecimal">
        SELECT sum(first_shall_amount)  FROM tb_shall_profit_detail
        WHERE first_dealer_id = #{dealerId} AND is_direct = 0 AND profit_date = #{profitDate}
    </select>
    <select id="selectFirstSecondHistoryProfitMoney" resultType="java.math.BigDecimal">
        SELECT sum(first_shall_amount)  FROM tb_shall_profit_detail
        WHERE first_dealer_id = #{dealerId} AND is_direct = 0
    </select>
    <select id="selectFirstMerchantYesterdayProfitMoney" resultType="java.math.BigDecimal">
        SELECT sum(first_shall_amount)  FROM tb_shall_profit_detail
        WHERE first_dealer_id = #{dealerId} AND is_direct = 1 AND profit_date = #{profitDate}
    </select>
    <select id="selectFirstMerchantHistoryProfitMoney" resultType="java.math.BigDecimal">
        SELECT sum(first_shall_amount)  FROM tb_shall_profit_detail
        WHERE first_dealer_id = #{dealerId} AND is_direct = 1
    </select>
    <select id="selectFirstYesterdayDealMoney" resultType="java.math.BigDecimal">
        SELECT sum(total_fee)  FROM tb_shall_profit_detail
        WHERE first_dealer_id = #{dealerId} AND is_direct = 1 AND profit_type = 1 AND profit_date = #{profitDate}
    </select>
    <select id="selectByOrderId" resultType="com.jkm.hss.dealer.entity.ShallProfitDetail">
        SELECT * FROM tb_shall_profit_detail where payment_sn = #{orderId}
    </select>
    <select id="selectCompanyCollectProfitByProfitDate" resultType="java.math.BigDecimal">
        SELECT sum(channel_shall_amount + product_shall_amount) FROM tb_shall_profit_detail
        WHERE profit_date = #{profitDate} AND profit_type = 1
    </select>
    <select id="selectCompanyWithdrawProfitByProfitDate" resultType="java.math.BigDecimal">
        SELECT sum(channel_shall_amount + product_shall_amount) FROM tb_shall_profit_detail
        WHERE profit_date = #{profitDate} AND profit_type = 2
    </select>
    <select id="selectByProfitDateAndSecondDealerId" resultType="com.jkm.hss.dealer.entity.ShallProfitDetail">
        SELECT * FROM tb_shall_profit_detail WHERE second_dealer_id = #{secondDealerId}
        AND profit_date = #{statisticsDate}
    </select>
    <select id="selectByProfitDateAndFirstDealerId" resultType="com.jkm.hss.dealer.entity.ShallProfitDetail">
        SELECT * FROM tb_shall_profit_detail WHERE first_dealer_id = #{firstDealerId}
        AND profit_date = #{statisticsDate}
    </select>
    <select id="selectCompanyByProfitDate" resultType="com.jkm.hss.dealer.entity.ShallProfitDetail">
        SELECT * FROM tb_shall_profit_detail WHERE profit_date = #{profitDate}
    </select>
    <select id="getMerchantIdByProfitDate" resultType="java.lang.Long">
        SELECT distinct(merchant_id) FROM tb_shall_profit_detail WHERE profit_date = #{statisticsDate}
    </select>
</mapper>