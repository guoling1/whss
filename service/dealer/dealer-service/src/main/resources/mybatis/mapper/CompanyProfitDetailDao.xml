<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jkm.hss.dealer.dao.CompanyProfitDetailDao">

    <insert id="add" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO tb_company_profit_detail
        (merchant_id,
        payment_sn,
        channel_type,
        total_fee,
        wait_shall_amount,
        wait_shall_origin_amount,
        profit_type,
        channel_cost,
        channel_shall_amount,
        product_shall_amount,
        profit_date,
        status
        )VALUES(
        #{merchantId},
        #{paymentSn},
        #{channelType},
        #{totalFee},
        #{waitShallAmount},
        #{waitShallOriginAmount},
        #{profitType},
        #{channelCost},
        #{channelShallAmount},
        #{productShallAmount},
        #{profitDate},
        #{status}
        )
    </insert>
    <select id="selectCollectProfitByProfitDate" resultType="java.math.BigDecimal">
        SELECT sum(product_shall_amount + channel_shall_amount) FROM tb_company_profit_detail WHERE profit_type = 1 AND profit_date = #{profitDate}
    </select>
    <select id="selectWithdrawProfitByProfitDate" resultType="java.math.BigDecimal">
        SELECT sum(product_shall_amount + channel_shall_amount) FROM tb_company_profit_detail WHERE profit_type = 2 AND profit_date = #{profitDate}
    </select>
</mapper>