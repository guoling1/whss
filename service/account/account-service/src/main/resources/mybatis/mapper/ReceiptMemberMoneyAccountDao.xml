<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jkm.hss.account.dao.ReceiptMemberMoneyAccountDao">
    <insert id="insert" useGeneratedKeys="true" keyProperty="id">
        insert into tb_receipt_member_money_account (recharge_total_amount, income_total_amount, status) values (#{rechargeTotalAmount}, #{incomeToTalAmount}, #{status});
    </insert>

    <update id="update">
        UPDATE tb_receipt_member_money_account
        <set>
            <if test="rechargeTotalAmount != null">
                recharge_total_amount = #{rechargeTotalAmount}
            </if>
            <if test="incomeToTalAmount != null">
                income_total_amount = #{incomeToTalAmount},
            </if>
            <if test="status > 0">
                status = #{status},
            </if>
        </set>
        WHERE id = #{id}
    </update>

    <update id="increaseIncomeAmount">
        UPDATE tb_receipt_member_money_account SET income_total_amount = income_total_amount + #{income} WHERE id = #{id}
    </update>

    <update id="decreaseIncomeAmount">
        UPDATE tb_receipt_member_money_account SET income_total_amount = income_total_amount - #{income} WHERE id = #{id}
    </update>

    <update id="increaseRechargeAmount">
         UPDATE tb_receipt_member_money_account SET recharge_total_amount = recharge_total_amount + #{recharge} WHERE id = #{id}
    </update>

    <select id="selectById" resultType="com.jkm.hss.account.entity.ReceiptMemberMoneyAccount">
        SELECT * FROM tb_receipt_member_money_account WHERE id = #{id}
    </select>

    <select id="selectByIdWithLock" resultType="com.jkm.hss.account.entity.ReceiptMemberMoneyAccount">
        SELECT * FROM tb_receipt_member_money_account WHERE id = #{id} FOR UPDATE
    </select>
</mapper>