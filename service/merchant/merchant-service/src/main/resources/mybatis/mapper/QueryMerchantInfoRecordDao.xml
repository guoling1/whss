<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jkm.hss.merchant.dao.QueryMerchantInfoRecordDao">

    <select id="getAll" resultType="com.jkm.hss.merchant.entity.MerchantInfoResponse">

        SELECT
            a.id,
            a.identity_face_pic,
            a.identity_opposite_pic,
            a.identity_hand_pic,
            a.bank_hand_pic,
            a.bank_pic,
            a.reserve_mobile,
            a.merchant_name,
            a.address,
            a.source,
            a.NAME,
            a.identity,
            a.bank_no,
            a.dealer_id,
            a.STATUS,
            a.bank_name,
            a.first_dealer_id,
            a.is_authen,
            a.create_time,
            a.mobile,
            a.authentication_time,
            a.checked_time,
            a.second_dealer_id,
            b.`level`,
            b.first_level_dealer_id,
            b.proxy_name
        FROM
            tb_merchant_info a
        LEFT JOIN
            tb_dealer b ON a.dealer_id=b.id
        WHERE
			a.id=#{id}
    </select>

    <!--查询推荐信息-->
    <select id="getRefInformation" resultType="com.jkm.hss.merchant.entity.ReferralResponse">
        SELECT
            (select d.proxy_name from tb_dealer as d where d.id=first_dealer_id) as proxy_name_yq,
            (select d.proxy_name from tb_dealer as d where d.id=second_dealer_id) as proxy_name_yq1
        FROM tb_merchant_info WHERE id=#{id}
    </select>

    <!--审核日志-->
    <select id="getLog" resultType="com.jkm.hss.merchant.entity.LogResponse">

        SELECT
            descr,
            status,
            create_time
        FROM
            tb_merchant_info_check_record
        WHERE
            merchant_id = #{id}
    </select>

    <select id="getLevel" resultType="com.jkm.hss.merchant.entity.MerchantInfoResponse">
        SELECT proxy_name,first_level_dealer_id FROM tb_dealer WHERE id=#{dealerId}

    </select>

    <select id="getResults" resultType="com.jkm.hss.merchant.entity.MerchantInfoResponse">
        SELECT proxy_name FROM tb_dealer WHERE id=#{dealerId} AND level=#{level}

    </select>

    <select id="getFirstLevel" resultType="com.jkm.hss.merchant.entity.MerchantInfoResponse">
        SELECT proxy_name FROM tb_dealer WHERE id=#{firstLevelDealerId}

    </select>


    <select id="getSettle" resultType="com.jkm.hss.merchant.entity.SettleResponse">
        SELECT weixin_rate,alipay_rate,fast_rate FROM tb_merchant_info WHERE id=#{id}
    </select>



</mapper>