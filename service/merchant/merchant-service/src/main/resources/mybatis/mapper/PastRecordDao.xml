<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jkm.hss.merchant.dao.PastRecordDao">
    <!-- 通用查询结果列-->
    <sql id="Base_Column_List">
        id,	past_no,	accoun_id,	trade_id,	order_id,	total_fee,	settle_period,	settle_status,	trade_type,	status,	create_time,	update_time
    </sql>

    <!-- 查询（根据主键ID查询） -->
    <select id="selectByPrimaryKey" resultType="com.jkm.hss.merchant.entity.PastRecord">
        SELECT
        <include refid="Base_Column_List" />
        FROM tb_past_record
        WHERE id = #{id} and status=0
    </select>

    <!-- 查询（已结算） -->
    <select id="selectSettleMoney" resultType="java.lang.Double">
        select Round(IFNULL(sum(total_fee),0),2)  as settleMoney from tb_past_record where accoun_id=#{accountId} and settle_status=0;
    </select>

    <!-- 查询（未结算） -->
    <select id="selectUnSettleMoney" resultType="java.lang.Double">
        select Round(IFNULL(sum(total_fee),0),2)  as unSettleMoney from tb_past_record where accoun_id=#{accountId} and settle_status=1;
    </select>

    <!-- 添加 （匹配有值的字段）-->
    <insert id="insertSelective" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO tb_past_record
        <trim prefix="(" suffix=")" suffixOverrides="," >
            <if test="pastNo != null">
                past_no,
            </if>
            <if test="accounId != null">
                accoun_id,
            </if>
            <if test="tradeId != null">
                trade_id,
            </if>
            <if test="orderId != null">
                order_id,
            </if>
            <if test="totalFee != null">
                total_fee,
            </if>
            <if test="settlePeriod != null">
                settle_period,
            </if>
            <if test="settleStatus != null">
                settle_status,
            </if>
            <if test="tradeType != null">
                trade_type,
            </if>
            <if test="status != null">
                status,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides="," >
            <if test="pastNo!=null">
                #{pastNo},
            </if>
            <if test="accounId!=null">
                #{accounId},
            </if>
            <if test="tradeId!=null">
                #{tradeId},
            </if>
            <if test="orderId!=null">
                #{orderId},
            </if>
            <if test="totalFee!=null">
                #{totalFee},
            </if>
            <if test="settlePeriod!=null">
                #{settlePeriod},
            </if>
            <if test="settleStatus!=null">
                #{settleStatus},
            </if>
            <if test="tradeType!=null">
                #{tradeType},
            </if>
            <if test="status!=null">
                #{status},
            </if>
        </trim>
    </insert>

    <!-- 修 改-->
    <update id="updateByPrimaryKey">
        UPDATE tb_past_record
        <set>
            <if test="pastNo != null">
                past_no = #{pastNo},
            </if>
            <if test="accounId != null">
                accoun_id = #{accounId},
            </if>
            <if test="tradeId != null">
                trade_id = #{tradeId},
            </if>
            <if test="orderId != null">
                order_id = #{orderId},
            </if>
            <if test="totalFee != null">
                total_fee = #{totalFee},
            </if>
            <if test="settlePeriod != null">
                settle_period = #{settlePeriod},
            </if>
            <if test="settleStatus != null">
                settle_status = #{settleStatus},
            </if>
            <if test="tradeType != null">
                trade_type = #{tradeType},
            </if>
            <if test="status != null">
                status = #{status},
            </if>
        </set>
        WHERE id = #{id}
    </update>


</mapper>