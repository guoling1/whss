<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jkm.hss.merchant.dao.WebsiteDao">

    <!-- 插入申请信息 -->
    <insert id="insertWebsite" useGeneratedKeys="true" keyProperty="id" >
        INSERT INTO tb_website (
            user_name,
            mobile,
            type,
            ip
            )
        VALUES
            (
            #{userName},
            #{mobile},
            #{type},
            #{ip})
    </insert>

    <select id="selectWebsite" resultType="java.lang.Integer">
       SELECT COUNT(ip) FROM tb_website WHERE ip = #{ip}
    </select>

    <!-- 查询申请合作用户列表 -->
    <select id="selectCooperation" resultType="com.jkm.hss.merchant.entity.CooperationQueryResponse">
        SELECT
            *
        FROM
            tb_website
        WHERE 1=1
    <if test="startTime!=null and startTime!=''">
        AND a.split_date <![CDATA[ >= ]]> #{startTime}
    </if>

    <if test="endTime!=null and endTime!=''">
        AND a.split_date <![CDATA[ <= ]]> #{endTime}
    </if>
        ORDER BY
            create_time DESC
        LIMIT #{offset},#{pageSize}
    </select>

    <!-- 查询申请合作用户列表总数 -->
    <select id="selectCooperationCount" resultType="java.lang.Integer">
        SELECT COUNT(id) FROM tb_website
        WHERE 1=1
    <if test="startTime!=null and startTime!=''">
        AND a.split_date <![CDATA[ >= ]]> #{startTime}
    </if>

    <if test="endTime!=null and endTime!=''">
        AND a.split_date <![CDATA[ <= ]]> #{endTime}
    </if>
    </select>

    <!-- 查询加盟用户列表 -->
    <select id="selectJoin" resultType="com.jkm.hss.merchant.entity.JoinResponse">
        SELECT
        *
        FROM
        tb_join
        WHERE 1=1
    <if test="startTime!=null and startTime!=''">
        AND a.split_date <![CDATA[ >= ]]> #{startTime}
    </if>

    <if test="endTime!=null and endTime!=''">
        AND a.split_date <![CDATA[ <= ]]> #{endTime}
    </if>
        ORDER BY
        create_time DESC
        LIMIT #{offset},#{pageSize}
    </select>

    <!-- 查询加盟用户列表总数 -->
    <select id="selectJoinCount" resultType="java.lang.Integer">
        SELECT COUNT(id) FROM tb_join
        WHERE 1=1
    <if test="startTime!=null and startTime!=''">
        AND a.split_date <![CDATA[ >= ]]> #{startTime}
    </if>

    <if test="endTime!=null and endTime!=''">
        AND a.split_date <![CDATA[ <= ]]> #{endTime}
    </if>
    </select>

    <!-- 查询手机号 -->
    <select id="selectMobile" resultType="java.lang.String">
        SELECT mobile FROM tb_join WHERE mobile = #{mobile}
    </select>

    <!-- 插入信息 -->
    <insert id="saveInfo" useGeneratedKeys="true" keyProperty="id" >
        INSERT INTO tb_join (
        user_name,
        mobile,
        company_name,
        province_code,
        province_name,
        city_code,
        city_name,
        county_code,
        county_name,
        type
        )
        VALUES
        (
        #{userName},
        #{mobile},
        #{companyName},
        #{provinceCode},
        #{provinceName},
        #{cityCode},
        #{cityName},
        #{countyCode},
        #{countyName},
        #{type})
    </insert>

</mapper>